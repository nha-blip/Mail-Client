<Window x:Class="Mailclient.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Mailclient"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        xmlns:chrome="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
        mc:Ignorable="d"
        MouseDown="Window_MouseDown"
        Title="MainWindow" Height="650" Width="1000"
        WindowStartupLocation="CenterScreen"
        FontFamily="Segoe UI"
        WindowStyle="None"
        ResizeMode="CanResize"
        AllowsTransparency="True"
        Background="Transparent">
    <WindowChrome.WindowChrome>
        <WindowChrome 
            CaptionHeight="0"  
            ResizeBorderThickness="7"
            GlassFrameThickness="0"
            CornerRadius="0" />
    </WindowChrome.WindowChrome>
    <Window.Resources>
        <Style x:Key="MenuButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Height" Value="50"/>
            <Setter Property="Margin" Value="10,5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <!--<Setter Property="FontFamily" Value="/Font/#Poppins"/>-->
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                CornerRadius="10" 
                                Background="{TemplateBinding Background}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <ContentPresenter x:Name="icon" Content="{TemplateBinding Tag}" 
                                                  HorizontalAlignment="Center" VerticalAlignment="Center"/>

                                <ContentPresenter Grid.Column="1" 
                                                  Content="{TemplateBinding Content}"
                                                  HorizontalAlignment="Left" VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#33FFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#66FFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="WindowControlButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Width" Value="40"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                      VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#33FFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#66FFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="MenuSearchButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Height" Value="50"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                        CornerRadius="50" 
                        Background="{TemplateBinding Background}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <ContentPresenter x:Name="icon" Content="{TemplateBinding Tag}" 
                                          HorizontalAlignment="Center" VerticalAlignment="Center"/>

                                <ContentPresenter Grid.Column="1" 
                                          Content="{TemplateBinding Content}"
                                          HorizontalAlignment="Left" VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#33FFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#66FFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ComposeButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#00C6FF"/>
            <Setter Property="Foreground" Value="#000"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontFamily" Value="/Font/#Poppins"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" CornerRadius="15" Background="{TemplateBinding Background}">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <ContentPresenter/>
                            </StackPanel>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#4FC3F7"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="SearchBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#F1F3F4"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground" Value="#333"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">

                        <Border x:Name="border"
                        Background="{TemplateBinding Background}"
                        CornerRadius="20" Height="40">

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <Image Source="/image/search.png"
                                       Margin="15,0,5,0"
                                       Height="20"
                                       RenderOptions.BitmapScalingMode="HighQuality"
                                       VerticalAlignment="Center"/>
                                <TextBlock x:Name="placeholder"
                                           Grid.Column="1"
                                           Margin="11,0,0,0"
                                           Text="Search mail"
                                           Foreground="Gray"
                                           VerticalAlignment="Center"
                                           Visibility="Collapsed"/>
                                <ScrollViewer x:Name="PART_ContentHost" 
                                              Grid.Column="1"
                                              VerticalAlignment="Center"/>
                            </Grid>
                        </Border>

                        <ControlTemplate.Triggers>

                            <Trigger Property="Text" Value="">
                                <Setter TargetName="placeholder" Property="Visibility" Value="Visible"/>
                            </Trigger>

                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="#0366FF"/>
                                <Setter TargetName="border" Property="BorderThickness" Value="1"/>
                            </Trigger>

                        </ControlTemplate.Triggers>

                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Border x:Name="mainborder">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="30"/>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="260"/>
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <Grid Grid.Row="0"
                  Grid.Column="0"
                  Grid.ColumnSpan="2"
                  Background="#30FFFFFF">
                <StackPanel HorizontalAlignment="Right"
                            Orientation="Horizontal">
                    <Button x:Name="btnMinimize" 
                            Style="{StaticResource WindowControlButtonStyle}" 
                            Content="&#xE921;"
                            FontFamily="Segoe MDL2 Assets" 
                            Click="Minimize"/>
                    <Button x:Name="btnMaximize" 
                            Style="{StaticResource WindowControlButtonStyle}" 
                            Content="&#xE922;"
                            FontFamily="Segoe MDL2 Assets" 
                            Click="Maximize"/>
                    <Button x:Name="Close" 
                            Style="{StaticResource WindowControlButtonStyle}" 
                            Content="&#xE8BB;"
                            FontFamily="Segoe MDL2 Assets" 
                            Click="close"/>
                </StackPanel>
            </Grid>
            <Border Grid.Row="1"
                    Grid.Column="0"
                    CornerRadius="8"
                    Grid.RowSpan="2"
                >
                <Grid x:Name="MainGrid1">
                    <Border CornerRadius="8,8,0,0" ClipToBounds="True">
                        <Rectangle Margin="-5">
                            <Rectangle.Effect>
                                <BlurEffect Radius="30" KernelType="Gaussian"/>
                            </Rectangle.Effect>
                            <Rectangle.Fill>
                                <VisualBrush Visual="{Binding ElementName=MainGrid1}" Stretch="None" AlignmentX="Center" AlignmentY="Center"/>
                            </Rectangle.Fill>
                        </Rectangle>
                    </Border>

                    <Border>
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">

                                <GradientStop Color="#30FFFFFF" Offset="0"/>

                                <GradientStop Color="#30FFFFFF" Offset="1"/>

                            </LinearGradientBrush>
                        </Border.Background>
                    </Border>
                    <Image Source="/image/logo_uit.png"
                           VerticalAlignment="Top"
                           Height="70"
                           Margin="0,10,0,0"
                           RenderOptions.BitmapScalingMode="HighQuality"
               />
                </Grid>
            </Border>
            <Grid Grid.Row="1" 
                  Grid.Column="1" 
                  Background="Transparent">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="60"/>
                    <ColumnDefinition Width="60"/>
                    <ColumnDefinition Width="120"/>
                </Grid.ColumnDefinitions>
                <Grid
                     Grid.Column="0"
                     Background="Transparent" 
                     MinHeight="64">
                    <Border CornerRadius="25" ClipToBounds="True">
                        <Rectangle Margin="-5">
                            <Rectangle.Effect>
                                <BlurEffect Radius="90" KernelType="Gaussian"/>
                            </Rectangle.Effect>
                            <Rectangle.Fill>
                                <VisualBrush Visual="{Binding ElementName=searchbox}" Stretch="None" AlignmentX="Center" AlignmentY="Center"/>
                            </Rectangle.Fill>
                        </Rectangle>
                    </Border>

                    <Border>
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">

                                <GradientStop Color="#30FFFFFF" Offset="0"/>

                                <GradientStop Color="#30FFFFFF" Offset="1"/>

                            </LinearGradientBrush>
                        </Border.Background>
                    </Border>
                    <TextBox x:Name="SearchBar"
                    Style="{StaticResource SearchBoxStyle}"
                         TextChanged="TextBox_TextChanged"
                         HorizontalAlignment="Stretch"
                         VerticalAlignment="Center"
                         Margin="10,0,70,0"/>
                </Grid>

                <Grid Grid.Column="1">
                    <Border CornerRadius="25" ClipToBounds="True">
                        <Rectangle Margin="-5">
                            <Rectangle.Effect>
                                <BlurEffect Radius="90" KernelType="Gaussian"/>
                            </Rectangle.Effect>
                            <Rectangle.Fill>
                                <VisualBrush Stretch="None" AlignmentX="Center" AlignmentY="Center"/>
                            </Rectangle.Fill>
                        </Rectangle>
                    </Border>

                    <Border>
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">

                                <GradientStop Color="#30FFFFFF" Offset="0"/>

                                <GradientStop Color="#30FFFFFF" Offset="1"/>

                            </LinearGradientBrush>
                        </Border.Background>
                    </Border>

                    <Button Style="{StaticResource MenuSearchButtonStyle}" HorizontalAlignment="Center">
                        <Button.Tag>
                            <Image Source="/image/information.png" Width="28" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </Button.Tag>
                    </Button>
                </Grid>

                <Grid Grid.Column="2">
                    <Border CornerRadius="25" ClipToBounds="True">
                        <Rectangle Margin="-5">
                            <Rectangle.Effect>
                                <BlurEffect Radius="90" KernelType="Gaussian"/>
                            </Rectangle.Effect>
                            <Rectangle.Fill>
                                <VisualBrush Stretch="None" AlignmentX="Center" AlignmentY="Center"/>
                            </Rectangle.Fill>
                        </Rectangle>
                    </Border>

                    <Border>
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">

                                <GradientStop Color="#30FFFFFF" Offset="0"/>

                                <GradientStop Color="#30FFFFFF" Offset="1"/>

                            </LinearGradientBrush>
                        </Border.Background>
                    </Border>

                    <Button Style="{StaticResource MenuSearchButtonStyle}" HorizontalAlignment="Center">
                        <Button.Tag>
                            <Image Source="/image/setting.png" Width="28" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </Button.Tag>
                    </Button>
                </Grid>
                <Grid Grid.Column="3">
                    <Border CornerRadius="25" ClipToBounds="True">
                        <Rectangle Margin="-5">
                            <Rectangle.Effect>
                                <BlurEffect Radius="30" KernelType="Gaussian"/>
                            </Rectangle.Effect>
                            <Rectangle.Fill>
                                <VisualBrush Visual="{Binding ElementName=searchbox}" Stretch="None" AlignmentX="Center" AlignmentY="Center"/>
                            </Rectangle.Fill>
                        </Rectangle>
                    </Border>

                    <Border>
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">

                                <GradientStop Color="#30FFFFFF" Offset="0"/>

                                <GradientStop Color="#30FFFFFF" Offset="1"/>

                            </LinearGradientBrush>
                        </Border.Background>
                    </Border>
                    <Button Content="Account"
                            x:Name="OpAccount"
                            Margin="0,5,18,5"
                        Width="90"
                        Style="{StaticResource ComposeButtonStyle}"
                        HorizontalAlignment="Right"
                        Click="OPLogin"/>
                </Grid>
            </Grid>

            <Border Grid.Row="2" 
                    Grid.Column="0" 
                    MinWidth="260">
                <Grid x:Name="MainGrid">
                    <StackPanel Margin="15,0,15,0">
                        <Button Style="{StaticResource ComposeButtonStyle}" 
                            Height="50"
                            Margin="10,30,10,10"
                            Content="✏️   Compose" 
                            Click="opcompose"/>

                        <Button Style="{StaticResource MenuButtonStyle}" Content="Inbox" Click="inbox" x:Name="inboxbt">
                            <Button.Tag>
                                <Image Source="/image/inbox.png" Width="24" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </Button.Tag>
                        </Button>

                        <Button Style="{StaticResource MenuButtonStyle}" Content="Sent" Click="sent" x:Name="sentbt">
                            <Button.Tag>
                                <Image Source="/image/sent.png" Width="22" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </Button.Tag>
                        </Button>

                        <Button Style="{StaticResource MenuButtonStyle}" Content="Spam" Click="spam" x:Name="spambt">
                            <Button.Tag>
                                <Image Source="/image/spam.png" Width="22" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </Button.Tag>
                        </Button>

                        <Button Style="{StaticResource MenuButtonStyle}" Content="Drafts" Click="drafts" x:Name="draftsbt">
                            <Button.Tag>
                                <Image Source="/image/drafts.png" Width="22" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </Button.Tag>
                        </Button>

                        <Button Style="{StaticResource MenuButtonStyle}" Content="All mail" Click="allmail" x:Name="allmailbt">
                            <Button.Tag>
                                <Image Source="/image/multiple-emails.png" Width="25" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </Button.Tag>
                        </Button>

                        <Button Style="{StaticResource MenuButtonStyle}" Content="Trash" Click="trash" x:Name="trashmailbt">
                            <Button.Tag>
                                <Image Source="/image/trashmail.png" Width="22" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </Button.Tag>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>
            <Border Grid.Row="2" 
                    Grid.Column="1"
                    CornerRadius="8"
                    ClipToBounds="True"
                    >
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="25"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <Border CornerRadius="25" ClipToBounds="True">
                            <Rectangle Margin="-5">
                                <Rectangle.Effect>
                                    <BlurEffect Radius="90" KernelType="Gaussian"/>
                                </Rectangle.Effect>
                                <Rectangle.Fill>
                                    <VisualBrush Stretch="None" AlignmentX="Center" AlignmentY="Center"/>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Border>

                        <Border>
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">

                                    <GradientStop Color="#30FFFFFF" Offset="0"/>

                                    <GradientStop Color="#30FFFFFF" Offset="1"/>

                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <StackPanel Orientation="Horizontal">
                            <CheckBox x:Name="SelectAll"
                                      HorizontalAlignment="Left"
                                      VerticalAlignment="Center"
                                      Margin="21,0,0,0"/>
                            <TextBlock Text="All" Foreground="White" HorizontalAlignment="Right"
                                       VerticalAlignment="Center"
                                       Margin="10,0,0,0"
                                       FontSize="15"
                                       FontFamily="/Font/#Poppins"/>
                            <Button Content="&#xE74D;" 
                                    Margin="10,0,0,0"
                                    x:Name="DeleteButton"
                                    FontFamily="Segoe MDL2 Assets" 
                                    FontSize="13" 
                                    Foreground="White"
                                    BorderThickness="0"
                                    Width="50"
                                    Background="Transparent"/>
                        </StackPanel>
                    </Grid>

                    <Grid x:Name="listview"
                          Grid.Row="1">
                        <Border CornerRadius="8"
                            Margin="10">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#FFFFFFFF" Offset="0"/>
                                    <GradientStop Color="#FFFFFFFF" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border.Effect>
                                <DropShadowEffect Color="Black" Opacity="0.05" BlurRadius="10" ShadowDepth="0"/>
                            </Border.Effect>
                        </Border>
                        <Border CornerRadius="25" ClipToBounds="True">
                            <Rectangle Margin="-5">
                                <Rectangle.Effect>
                                    <BlurEffect Radius="90" KernelType="Gaussian"/>
                                </Rectangle.Effect>
                                <Rectangle.Fill>
                                    <VisualBrush Visual="{Binding ElementName=listview}" Stretch="None" AlignmentX="Center" AlignmentY="Center"/>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Border>

                        <Border>

                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">

                                    <GradientStop Color="#30FFFFFF" Offset="0"/>

                                    <GradientStop Color="#30FFFFFF" Offset="1"/>

                                </LinearGradientBrush>
                            </Border.Background>
                        </Border>
                        <ListBox x:Name="MyEmailList"
                                 BorderThickness="0"
                                 SelectionChanged="content"
                                 VirtualizingPanel.IsVirtualizing="True"
                                  VirtualizingPanel.VirtualizationMode="Recycling"
                                  VirtualizingPanel.CacheLengthUnit="Page"
                                  VirtualizingPanel.CacheLength="1,1"
                                 Background="Transparent" 
                                 HorizontalContentAlignment="Stretch"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                            <ListBox.Resources>

                                <Style x:Key="ScrollBarLineButton" TargetType="{x:Type RepeatButton}">
                                    <Setter Property="Focusable" Value="False"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type RepeatButton}">
                                                <Border Background="Transparent" Width="17" Height="17">
                                                    <Path Data="{Binding Content, RelativeSource={RelativeSource TemplatedParent}}" 
                                                      Fill="#606060" 
                                                      HorizontalAlignment="Center" 
                                                      VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Cursor" Value="Hand"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>

                                <Style x:Key="ScrollBarThumb" TargetType="{x:Type Thumb}">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type Thumb}">
                                                <Border x:Name="border" 
                                                        CornerRadius="8" 
                                                        Background="#CDCDCD" 
                                                        Margin="4,0" />

                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter TargetName="border" Property="Background" Value="#A6A6A6"/>
                                                    </Trigger>
                                                    <Trigger Property="IsDragging" Value="True">
                                                        <Setter TargetName="border" Property="Background" Value="#606060"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>

                                <Style TargetType="{x:Type ScrollBar}">
                                    <Setter Property="Width" Value="17"/>
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type ScrollBar}">
                                                <Grid x:Name="GridRoot" Background="{TemplateBinding Background}">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition MaxHeight="17"/>
                                                        <RowDefinition Height="0.00001*"/>
                                                        <RowDefinition MaxHeight="17"/>
                                                    </Grid.RowDefinitions>

                                                    <RepeatButton Grid.Row="0" Style="{StaticResource ScrollBarLineButton}" Command="ScrollBar.LineUpCommand">
                                                        <RepeatButton.Content>
                                                            <Geometry>M 0 4 L 3.5 0 L 7 4 Z</Geometry>
                                                        </RepeatButton.Content>
                                                    </RepeatButton>

                                                    <Track x:Name="PART_Track" Grid.Row="1" IsDirectionReversed="true" Focusable="false">
                                                        <Track.Thumb>
                                                            <Thumb Style="{StaticResource ScrollBarThumb}"/>
                                                        </Track.Thumb>
                                                    </Track>

                                                    <RepeatButton Grid.Row="2" Style="{StaticResource ScrollBarLineButton}" Command="ScrollBar.LineDownCommand">
                                                        <RepeatButton.Content>
                                                            <Geometry>M 0 0 L 3.5 4 L 7 0 Z</Geometry>
                                                        </RepeatButton.Content>
                                                    </RepeatButton>
                                                </Grid>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </ListBox.Resources>
                            <ListBox.Margin>10,10,10,10</ListBox.Margin>
                            <ListBox.ItemContainerStyle>
                                <Style TargetType="ListBoxItem">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Margin" Value="0,2"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="ListBoxItem">
                                                <Border x:Name="Bd" 
                                                CornerRadius="10" 
                                                Background="{TemplateBinding Background}" >
                                                    <ContentPresenter/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <!--<Trigger Property="IsMouseOver" Value="True">
                                            <Setter  Property="Background" Value="#E5F3FF"/>
                                        </Trigger>
                                        -->
                                        <!--<DataTrigger Binding="{Binding IsChecked}" Value="True">
                                            <Setter Property="Background" Value="Aqua"/>
                                        </DataTrigger>-->
                                    </Style.Triggers>
                                </Style>
                            </ListBox.ItemContainerStyle>

                            <ListBox.ItemTemplate>
                                <DataTemplate>

                                    <Border Background="White" 
                                            x:Name="bgemail"
                                            CornerRadius="10" 
                                            BorderThickness="0"
                                            Margin="5,5,5,5" 
                                            Padding="10">
                                        <Border.Effect>
                                            <DropShadowEffect x:Name="shadow"
                                              Color="Black" 
                                              Direction="270" 
                                              ShadowDepth="2" 
                                              BlurRadius="5" 
                                              Opacity="0.1"/>
                                        </Border.Effect>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="30"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="80"/>
                                            </Grid.ColumnDefinitions>

                                            <CheckBox x:Name="Checkbox1" Grid.Column="0"/>

                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock Text="{Binding SenderName}" FontWeight="Bold" FontSize="15" TextTrimming="CharacterEllipsis"/>
                                                <TextBlock Text="{Binding Subject}" Foreground="#9E9E9E" FontSize="13" TextTrimming="CharacterEllipsis"/>
                                            </StackPanel>

                                            <Grid Grid.Column="2" >
                                                <Button Content="&#xE74D;" 
                                                    x:Name="DeleteButton"
                                                    FontFamily="Segoe MDL2 Assets" 
                                                    FontSize="16" 
                                                    BorderThickness="0"
                                                    HorizontalAlignment="Right"
                                                    Width="50"
                                                    Background="Transparent"
                                                    Visibility="Hidden"
                                                    Click="deletemail"/>
                                                <TextBlock Text="{Binding DateDisplay}" 
                                                       x:Name="DateText"
                                                       FontSize="12" 
                                                       Foreground="Gray" 
                                                       HorizontalAlignment="Right" 
                                                       VerticalAlignment="Center"/>
                                            </Grid>
                                        </Grid>
                                    </Border>

                                    <DataTemplate.Triggers>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsMouseOver}" Value="True">
                                            <Setter TargetName="DateText" Property="Visibility" Value="Hidden"/>
                                            <Setter TargetName="DeleteButton" Property="Visibility" Value="Visible"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=IsMouseOver}" Value="True">
                                            <Setter TargetName="bgemail" Property="BorderBrush" Value="#0078D4"/>
                                            <Setter TargetName="bgemail" Property="Background" Value="#E5F5FF"/>
                                            <Setter TargetName="bgemail" Property="Effect">
                                                <Setter.Value>
                                                    <DropShadowEffect Color="Black" 
                                                                      Direction="270" 
                                                                      ShadowDepth="2" 
                                                                      BlurRadius="5" 
                                                                      Opacity="0.3"/>
                                                </Setter.Value>
                                            </Setter>
                                        </DataTrigger>
                                    </DataTemplate.Triggers>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                        <Border x:Name="mailcontent" 
                                Margin="10" 
                                Background="White"
                                Visibility="Collapsed"
                                ClipToBounds="True"
                                CornerRadius="10"
                                >
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="10"/>
                                </Grid.RowDefinitions>
                                <Button x:Name="return" 
                                        Grid.Row="0"
                                        Focusable="False"
                                        Height="30"
                                        Width="50"
                                        Style="{StaticResource MenuSearchButtonStyle}"
                                        HorizontalAlignment="Left"
                                        Click="returnMain"
                                        PreviewMouseLeftButtonDown="returnmainW">
                                    <Button.Tag>
                                        <Image Source="/image/left-arrow.png" 
                                               VerticalAlignment="Top"
                                               Height="25"
                                               RenderOptions.BitmapScalingMode="HighQuality"/>
                                    </Button.Tag>
                                </Button>
                                <wv2:WebView2 x:Name="contentEmail"
                                              Grid.Row="1"/>
                                <Grid Grid.Row="2" />
                            </Grid>
                        </Border>
                        <local:Compose x:Name="composecontent"
                           Visibility="Collapsed"
                           HorizontalAlignment="Right"
                           VerticalAlignment="Bottom"
                           Margin="10"/>
                    </Grid>
                </Grid>
            </Border>
            <Popup x:Name="AccountPopup"
                   PlacementTarget="{Binding ElementName=OpAccount}" 
                   Placement="Bottom"
                   HorizontalOffset="-200" 
                   VerticalOffset="10"
                   StaysOpen="False"
                   AllowsTransparency="True"
                   PopupAnimation="Fade">

                <local:ListAccount x:Name="ListAccountControl" 
                                   />
            </Popup>
        </Grid>
    </Border>
</Window>
